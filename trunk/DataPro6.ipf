//	DataPro//	DAC/ADC macros for use with Igor Pro and the ITC-16 or ITC-18//	Nelson Spruston//	Northwestern University//	project began 10/27/1998//	last updated 7/28/2004#pragma rtGlobals=1		// Use modern global access method.#include <Strings as Lists>#include "DP6_Acquire"#include "DP6_BrowserModelMethods"#include "DP6_BrowserViewMethods"#include "DP6_BrowserControllerMethods"#include "DP6_Analyze"#include "DP6_Utilities"//#include "DP6_Image"#include "DP6_SIDX"#include "DP6_Windows"#include "DP6_MyVariables"#include "DP6_MyProcedures"#include "DP6_MyProcedures"//#include "DP6_LTP"//---------------------- DataPro MENU -----------------------//Menu "DataPro"	"Start DataPro", StartDataPro()	"DataPro6", RaiseOrCreatePanel("DataPro6")	"Create DataPro Browser", CreateDataProBrowser()	"-"	"DataAcq Panel", RaiseOrCreatePanel("DataAcq")	"ADC DAC Control Panel", RaiseOrCreatePanel("ADCDACControl")	"-"	"Calibrator"	"SetDataUnits"	"GetRidofGraphAxes"	"Display Series"	"Kill Windows"	"Kill Waves With Name"EndMacro StartDataPro()	PauseUpdate; Silent 1	String savDF=GetDataFolder(1)	NewDataFolder /O/S root:DP_ADCDACcontrol	NewPath DataPro6 "C:\\Documents and Settings\\Adam\\My Documents\\WaveMetrics\\Igor Pro 6 User Files\\User Procedures\\DataPro\\trunk\\"	LoadPICT /P=DataPro6 "DataProMenu.jpg", DataProMenu	SetupGlobals()	MakeADCDACWaves()	SetDACGain(dacout)	SetADCGain(adcin)	BuildTestPulse()	BuildStepPulse()	BuildSynTTLPulse()	RaiseOrCreatePanel("DataPro6")//	if (wintype("DataPro6")<1)//		DataPro6()//	endif	SetDataFolder savDFEndFunction AcquisitionPopMenuProc(ctrlName,popNum,popStr) : PopupMenuControl	String ctrlName	Variable popNum	String popStrEndWindow StartPanel() : Panel	PauseUpdate; Silent 1		// building window...	NewPanel /W=(271,307,737,541)	SetDrawLayer UserBack	SetDrawEnv fstyle= 1	DrawText 68,30,"It is very important that you save this as an"	SetDrawEnv fstyle= 1	DrawText 38,56,"unpacked experiment before you begin acquiring data."	SetDrawEnv fstyle= 1	DrawText 66,85,"Click the start button below and this will be"	SetDrawEnv fstyle= 1	DrawText 86,115,"the first thing you are prompted to do."	Button startbutton0,pos={177,136},size={100,30},proc=StartButtonProc,title="Start DataPro"EndMacroFunction StartButtonProc(ctrlName) : ButtonControl	String ctrlName	Execute "StartDataPro()"	DoWindow /K StartPanel//	HideProcedures//	SaveExperimentEnd