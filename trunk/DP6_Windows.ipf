//	DataPro//	DAC/ADC macros for use with Igor Pro and the ITC-16 or ITC-18//	Nelson Spruston//	Northwestern University//	project began 10/27/1998//	last updated 1/12/2000//______________________________DataPro Acquire WINDOWS __________________________//Window DataPro6() : Panel	if (wintype("DataPro6")>0)		DoWindow /F DataPro6	else		PauseUpdate; Silent 1		// building window...		NewPanel /W=(2,45,177,547)		SetDrawLayer UserBack		DrawPICT 1,0,1,1,DataProMenu		SetDrawEnv fillfgc= (56797,56797,56797)		DrawRect 1.102,-0.46,-0.108,-0.08		DrawLine -0.112,-0.157,1.078,-0.157		SetDrawEnv gstart		SetDrawEnv linefgc= (65535,65535,0),fillfgc= (65535,65535,0),fname= "Helvetica",fsize= 36,fstyle= 1,textrgb= (0,43690,65535)		DrawText 16,49,"DataPro"		SetDrawEnv gstop		SetDrawEnv fsize= 10,fstyle= 1,textrgb= (65535,65535,0)		DrawText 24,426,"data acquisition and"		SetDrawEnv fsize= 10,fstyle= 1,textrgb= (65535,65535,0)		DrawText 24,446,"analysis macros for"		SetDrawEnv fsize= 10,fstyle= 1,textrgb= (65535,65535,0)		DrawText 24,466,"use with Igor Pro &"		SetDrawEnv fsize= 10,fstyle= 1,textrgb= (65535,65535,0)		DrawText 24,486,"Instrutech ITC16/18"		DrawLine -0.11,-0.29,1.08,-0.29		Button data_button,pos={24,205},size={120,20},proc=DataButtonProc,title="Acquire"		Button adc_dac_button,pos={24,235},size={120,20},proc=ADC_DACButtonProc,title="ADC/DAC control"		Button tp_button,pos={24,265},size={120,20},proc=TPWinButtonProc,title="Test pulse"		Button pulse_button,pos={24,295},size={120,20},proc=DACBuilderButtonProc,title="DAC Pulse Builder"		//Button imaging_button,pos={24,325},size={120,20},proc=ImagingButtonProc,title="Imaging"		//Button analyze_button,pos={24,355},size={120,20},proc=AnalyzeButtonProc,title="Analyze"	endifEndMacroWindow DataProBrowser() : Graph	// Figure out what the index of this DataProBrowser instance should be	Variable browserNumber	browserNumber=DetermineBrowserNumberForNew()	// Save the current DF	String savedDFSpec=GetDataFolder(1)		// Create a new data folder for this instance to store some state variables in, switch to it	String browserDFName=BrowserDFNameFromNumber(browserNumber)	NewDataFolder /O/S $browserDFName	// Create the state variables for this instance	//Variable /G iOldSweep, 	Variable /G iCurrentSweep=1	String /G baseName1=root:DP_ADCDACcontrol:adcname0	String /G baseName2=root:DP_ADCDACcontrol:adcname1	//String /G oldbname1=baseName1	//String /G oldbname2=baseName2	Variable /G hold1, hold2	Variable /G step1, step2	String /G newWave1Name, newWave2Name	String /G topWaveName	String /G comments	Variable /G yMin=-3, yMax=3, xMin=0, xMax=100	// Make waves for colors	Make /O/N=(8,3) Colors	Colors[][0]={0,65535,3,29524,4369,39321,65535}	Colors[][1]={0,0,52428,1,4369,26208,0}	Colors[][2]={65535,0,1,58982,4369,1,26214}	// Layout the window widgets	PauseUpdate; Silent 1		// building window...	String browserName=BrowserNameFromNumber(browserNumber)	String browserTitle=BrowserTitleFromNumber(browserNumber)	Display /W=(177,44,757,548)/N=$browserName as browserTitle	ShowInfo	ControlBar 100	CheckBox autoscaley_check,pos={106,80},size={72,14},proc=RescaleCheckProc,title="Autoscale y"	CheckBox autoscaley_check,value= 1	CheckBox autoscalex_check,pos={206,80},size={72,14},proc=RescaleCheckProc,title="Autoscale x"	CheckBox autoscalex_check,value= 1		String absVarName=AbsoluteVarName(browserDFName,"iCurrentSweep")	SetVariable setsweep,pos={11,15},size={100,18},proc=GoToSweep,title="Wave"	SetVariable setsweep,fSize=12	//SetVariable setsweep,limits={1,100000,1},value= $absVarName	SetVariable setsweep,limits={1,100000,1},value=_NUM:1		CheckBox show1,pos={125,7},size={39,14},proc=AppRemSweep,title="ch.1",value= 1	CheckBox show2,pos={125,27},size={39,14},proc=AppRemSweep,title="ch.2",value= 0		absVarName=AbsoluteVarName(browserDFName,"baseName1")	SetVariable bnameset_0,pos={176,7},size={80,15},proc=GoToSweepName,title="name"	SetVariable bnameset_0,value=$absVarName		absVarName=AbsoluteVarName(browserDFName,"baseName2")	SetVariable bnameset_1,pos={176,27},size={80,15},proc=GoToSweepName,title="name"	SetVariable bnameset_1,value=$absVarName		CheckBox basesub1,pos={262,7},size={61,14},proc=BaseSub,title="Base Sub"	CheckBox basesub1,value= 0	CheckBox basesub2,pos={262,27},size={61,14},proc=BaseSub,title="Base Sub"	CheckBox basesub2,value= 0	CheckBox reject1,pos={335,7},size={49,14},proc=RejectAccept,title="Reject"	CheckBox reject1,value= 0	CheckBox reject2,pos={335,27},size={49,14},proc=RejectAccept,title="Reject"	CheckBox reject2,value= 0		absVarName=AbsoluteVarName(browserDFName,"hold1")	SetVariable hold1_disp,pos={400,7},size={70,15},title="Hold",format="%3.3g"	SetVariable hold1_disp,limits={0,0,0},value=$absVarName		absVarName=AbsoluteVarName(browserDFName,"hold2")	SetVariable hold2_disp,pos={400,27},size={70,15},title="Hold",format="%3.3g"	SetVariable hold2_disp,limits={0,0,0},value=$absVarName		absVarName=AbsoluteVarName(browserDFName,"step1")	SetVariable step1_disp,pos={480,7},size={70,15},proc=SetStepVarProc,title="Step"	SetVariable step1_disp,limits={0,0,0},value=$absVarName		absVarName=AbsoluteVarName(browserDFName,"step2")	SetVariable step2_disp,pos={480,27},size={70,15},proc=SetStepVarProc,title="Step"	SetVariable step2_disp,limits={0,0,0},value=$absVarName		absVarName=AbsoluteVarName(browserDFName,"comments")	SetVariable show_comments,pos={20,55},size={260,15},title="comments"	SetVariable show_comments,value=$absVarName		Button measure,pos={690,15},size={70,18},proc=Measure,title="Measure"	Button fit,pos={690,40},size={70,18},proc=Fit,title="Fit"	Button avgswps,pos={690,65},size={70,18},proc=AverageSweeps,title="Average"		// Update all the values	UpdateValues(browserNumber)EndMacroWindow DataAcqPanel() : Panel	PauseUpdate; Silent 1		// building window...	String savDF=GetDataFolder(1)	SetDataFolder root:DP_ADCDACcontrol	NewPanel /W=(757,44,1051,430) as "Data Acquisition Panel"	GroupBox DataAcqGroup,pos={6,3},size={279,88},title="Data Acquisition"	SetVariable wavenumber_val,pos={130,23},size={100,15},title="next wave"	SetVariable wavenumber_val,format="%d"	SetVariable wavenumber_val,limits={0,10000,1},value= wavenumber	SetVariable setvar1,pos={135,183},size={115,15},title="samp. int."	SetVariable setvar1,limits={0.001,100,0.01},value=sintdp	SetVariable set_sweep_interval,pos={138,50},size={140,15},title="one every n seconds"	SetVariable set_sweep_interval,limits={1,10000,1},value= root:DP_ADCDACcontrol:sweep_interval	SetVariable set_comments,pos={12,69},size={270,15},title="comments"	SetVariable set_comments,value= root:DP_ADCDACcontrol:wave_comments	GroupBox SubtractionGroup,pos={6,94},size={279,40},title="P/N subtraction"	CheckBox pn_check,pos={49,111},size={54,14},title="pN sub.",value= 0	SetVariable pnsetvar0,pos={151,110},size={70,15},title="pN"	SetVariable pnsetvar0,value= root:DP_ADCDACcontrol:pn	GroupBox StepPulseGroup,pos={6,139},size={280,71},title="StepPulse_DAC"	SetVariable dpamp,pos={22,161},size={95,15},proc=DPampProc,title="step amp."	SetVariable dpamp,limits={-1000,10000,10},value= root:DP_ADCDACcontrol:dpamp	SetVariable dpdur,pos={131,161},size={120,15},proc=DPdurProc,title="step. dur."	SetVariable dpdur,limits={1e-05,100000,100},value= root:DP_ADCDACcontrol:dpdur	GroupBox SynPulseGroup,pos={6,213},size={280,49},title="SynPulse_DAC"	SetVariable syntime,pos={38,234},size={85,15},title="time"	SetVariable syntime,limits={0,1000,10},value= root:DP_ADCDACcontrol:syntime	SetVariable syndur,pos={146,234},size={80,15},title="dur."	SetVariable syndur,limits={0.001,10,0.1},value= root:DP_ADCDACcontrol:syndur	GroupBox TestPulseGroup,pos={5,266},size={280,111},title="Test Pulse"	SetVariable setvar0,pos={9,313},size={100,15},title="samp. int."	SetVariable setvar0,limits={0.01,100,0.01},value= root:DP_ADCDACcontrol:sinttp	CheckBox tp_bsub,pos={183,283},size={58,14},title="Base Sub"	CheckBox tp_bsub,value=1	CheckBox tpgate_check,pos={183,357},size={58,14},proc=TPgateCheckProc,title="Use Gate"	CheckBox tpgate_check,value=0	SetVariable tpamp,pos={142,300},size={130,15},proc=TPampProc,title="amplitude (mV)"	SetVariable tpamp,limits={-1000,1000,1},value= root:DP_ADCDACcontrol:tpamp	SetVariable tpdur,pos={152,319},size={120,15},title="duration (ms)"	SetVariable tpdur,limits={1,1000,1},value= root:DP_ADCDACcontrol:tpdur	SetVariable tpgate,pos={142,339},size={130,15},proc=TPampProc,title="gate amp. (mV)"	SetVariable tpgate,limits={-1000,1000,1},value= root:DP_ADCDACcontrol:tpgateamp	SetVariable test_adc,pos={10,353},size={90,15},title="show ADC"	SetVariable test_adc,limits={0,7,1},value= root:DP_ADCDACcontrol:testadc	SetVariable test_dac,pos={19,333},size={80,15},title="use DAC"	SetVariable test_dac,limits={0,7,1},value= root:DP_ADCDACcontrol:testdac	Button getdatabutton0,pos={19,22},size={80,20},proc=DataAcqButtonProc,title="Get Data"	CheckBox autoanalyzebutton,pos={129,3},size={58,14},title="Auto Analyze On"	Button start_tp_button0,pos={13,283},size={80,20},proc=TPStartButtonProc,title="Start"	SetVariable set_numacquire,pos={13,51},size={120,15},title="repeat n times"	SetVariable set_numacquire,value= root:DP_ADCDACcontrol:numacquire	SetDataFolder savDFEndMacroWindow TestPulseDisplay() : Graph	PauseUpdate; Silent 1		// building window...	String savDF=GetDataFolder(1)	SetDataFolder root:DP_ADCDACcontrol	Display /W=(757,453,1051,692) TestPulse_ADC as "Test Pulse Display"	ModifyGraph margin(top)=43	ModifyGraph grid(left)=1	Label left "\\F'Helvetica'\\Z12\\f01picoAmperes"	Label bottom "\\F'Helvetica'\\Z12\\f01milliseconds"	SetAxis left -6.75,7.5	ValDisplay rseal_val,pos={130,12},size={120,17},fSize=12,format="%10.3f"	ValDisplay rseal_val,limits={0,0,0},barmisc={0,1000},value=root:DP_ADCDACcontrol:rseal	SetDrawLayer UserFront	SetDrawEnv xcoord= rel,ycoord= rel,fillfgc= (56797,56797,56797)	DrawRect -0.01,-0.06,1,0.115	SetDrawEnv xcoord= rel,ycoord= rel,fillfgc= (52428,52428,52428),fsize= 18	SetDrawEnv save	SetDrawEnv fsize= 12	DrawText 0.05,0.09,"Resistance"	SetDrawEnv fsize= 12	DrawText 0.79,0.09,"GOhm"	SetDataFolder savDFEndMacroWindow ADC_DACcontrol() : Panel	PauseUpdate; Silent 1		// building window...	String savDF=GetDataFolder(1)	SetDataFolder root:DP_ADCDACcontrol	NewPanel /W=(176,570,872,862)	SetDrawLayer UserBack	SetDrawEnv linethick= 2	DrawLine 496,126,717,126	SetDrawEnv linethick= 2	DrawLine 279,0,279,301	SetDrawEnv linethick= 2	DrawLine 494,-3,494,300	SetDrawEnv fsize= 10	DrawText 90,264,"Voltage clamp: V/pA"	SetDrawEnv fsize= 10	DrawText 90,279,"Current clamp: V/mV"	SetDrawEnv fsize= 10	DrawText 370,264,"Voltage clamp: mV/V"	SetDrawEnv fsize= 10	DrawText 370,279,"Current clamp: pA/V"	SetDrawEnv fstyle= 1	DrawText 4,269,"Gain units:"	SetDrawEnv fstyle= 1	DrawText 282,270,"Gain units:"//	CheckBox Vclamp_check,pos={504,231},size={84,14},proc=ClampModeProc,title="voltage clamp"//	CheckBox Vclamp_check,value= 1//	CheckBox Cclamp_check,pos={596,232},size={88,14},proc=ClampModeProc,title="current clamp"//	CheckBox Cclamp_check,value= 0	PopupMenu clampmode0,pos={61,9},size={43,20}	PopupMenu clampmode0,mode=1,value= #"\"VC;CC\""	PopupMenu clampmode0, proc=ClampModeProc	PopupMenu clampmode1,pos={62,39},size={43,20}	PopupMenu clampmode1,mode=2,value= #"\"VC;CC\""	PopupMenu clampmode1, proc=ClampModeProc	adcgain1=adcgain1_cc	PopupMenu clampmode2,pos={61,72},size={43,20}	PopupMenu clampmode2,mode=1,value= #"\"VC;CC\""	PopupMenu clampmode2, proc=ClampModeProc	PopupMenu clampmode3,pos={62,103},size={43,20}	PopupMenu clampmode3,mode=1,value= #"\"VC;CC\""	PopupMenu clampmode3, proc=ClampModeProc	PopupMenu clampmode4,pos={62,136},size={43,20}	PopupMenu clampmode4,mode=1,value= #"\"VC;CC\""	PopupMenu clampmode4, proc=ClampModeProc	PopupMenu clampmode5,pos={62,166},size={43,20}	PopupMenu clampmode5,mode=1,value= #"\"VC;CC\""	PopupMenu clampmode5, proc=ClampModeProc	PopupMenu clampmode6,pos={60,197},size={43,20}	PopupMenu clampmode6,mode=1,value= #"\"VC;CC\""	PopupMenu clampmode6, proc=ClampModeProc	PopupMenu clampmode7,pos={62,228},size={43,20}	PopupMenu clampmode7,mode=1,value= #"\"VC;CC\""	PopupMenu clampmode7, proc=ClampModeProc	Button switchclampbutton0,pos={544,256},size={100,20},proc=ToggleClampButtonProc,title="VC <--> CC"//	Gain settings		SetVariable dacgainval_0,pos={354,11},size={85,15},proc=ResetGains,title="gain"	SetVariable dacgainval_0,format="%g",limits={0.0001,10000,0},value= dacgain0	SetVariable dacgainval_1,pos={361,71},size={85,15},proc=ResetGains,title="gain"	SetVariable dacgainval_1,format="%g",limits={0.0001,10000,1},value= dacgain1	SetVariable dacgainval_2,pos={361,135},size={85,15},proc=ResetGains,title="gain"	SetVariable dacgainval_2,format="%g",limits={0.0001,10000,10},value= dacgain2	SetVariable dacgainval_3,pos={361,201},size={85,15},proc=ResetGains,title="gain"	SetVariable dacgainval_3,format="%g",limits={0.0001,10000,1},value= dacgain3	SetVariable adcgainval_0,pos={110,12},size={85,15},proc=ResetGains,title="gain"	SetVariable adcgainval_0,format="%g",limits={0.0001,10000,10},value= adcgain0	SetVariable adcgainval_1,pos={110,42},size={85,15},proc=ResetGains,title="gain"	SetVariable adcgainval_1,format="%g",limits={0.0001,10000,10},value= adcgain1	SetVariable adcgainval_2,pos={112,75},size={85,15},proc=ResetGains,title="gain"	SetVariable adcgainval_2,format="%g",limits={0.0001,10000,10},value= adcgain2	SetVariable adcgainval_3,pos={112,105},size={85,15},proc=ResetGains,title="gain"	SetVariable adcgainval_3,format="%g",limits={0.0001,10000,10},value= adcgain3	SetVariable adcgainval_4,pos={112,136},size={85,15},proc=ResetGains,title="gain"	SetVariable adcgainval_4,format="%g",limits={0.0001,10000,10},value= adcgain4	SetVariable adcgainval_5,pos={113,166},size={85,15},proc=ResetGains,title="gain"	SetVariable adcgainval_5,format="%g",limits={0.0001,10000,10},value= adcgain5	SetVariable adcgainval_6,pos={110,199},size={85,15},proc=ResetGains,title="gain"	SetVariable adcgainval_6,format="%g",limits={0.0001,10000,10},value= adcgain6	SetVariable adcgainval_7,pos={111,229},size={85,15},proc=ResetGains,title="gain"	SetVariable adcgainval_7,format="%g",limits={0.0001,10000,10},value= adcgain7	Button readgain_button,pos={532,174},size={120,20},proc=ReadControlButtonProc,title="Read set from file"	Button savegain_button,pos={532,202},size={120,20},proc=SaveControlButtonProc,title="Save set to file"	CheckBox adcon_0,pos={10,12},size={44,14},proc=ADCDACcheckProc,title="ADC0"	CheckBox adcon_0,value= 1	CheckBox adcon_1,pos={10,42},size={44,14},proc=ADCDACcheckProc,title="ADC1"	CheckBox adcon_1,value= 0	CheckBox dacon_0,pos={288,10},size={44,14},proc=ADCDACcheckProc,title="DAC0"	CheckBox dacon_0,value= 1	CheckBox dacon_1,pos={289,71},size={44,14},proc=ADCDACcheckProc,title="DAC1"	CheckBox dacon_1,value= 0	CheckBox dacon_2,pos={291,135},size={44,14},proc=ADCDACcheckProc,title="DAC2"	CheckBox dacon_2,value= 0	CheckBox dacon_3,pos={291,200},size={44,14},proc=ADCDACcheckProc,title="DAC3"	CheckBox dacon_3,value= 0	CheckBox adcon_2,pos={11,76},size={44,14},proc=ADCDACcheckProc,title="ADC2"	CheckBox adcon_2,value= 0	CheckBox adcon_3,pos={11,107},size={44,14},proc=ADCDACcheckProc,title="ADC3"	CheckBox adcon_3,value= 0	CheckBox adcon_4,pos={10,138},size={44,14},proc=ADCDACcheckProc,title="ADC4"	CheckBox adcon_4,value= 0	CheckBox adcon_5,pos={10,168},size={44,14},proc=ADCDACcheckProc,title="ADC5"	CheckBox adcon_5,value= 0	CheckBox adcon_6,pos={11,199},size={44,14},proc=ADCDACcheckProc,title="ADC6"	CheckBox adcon_6,value= 0	CheckBox adcon_7,pos={10,229},size={44,14},proc=ADCDACcheckProc,title="ADC7"	CheckBox adcon_7,value= 0	PopupMenu dacpopup_0,pos={287,34},size={113,20}	PopupMenu dacpopup_0,mode=3,popvalue="StepPulse_DAC",value=#"\"_none_;\"+GetPopupItems(\"DAC\")"	PopupMenu dacpopup_1,pos={291,95},size={113,20}	PopupMenu dacpopup_1,mode=1,popvalue="StepPulse_DAC",value=#"\"_none_;\"+GetPopupItems(\"DAC\")"	PopupMenu dacpopup_2,pos={290,161},size={113,20}	PopupMenu dacpopup_2,mode=1,popvalue="StepPulse_DAC",value=#"\"_none_;\"+GetPopupItems(\"DAC\")"	PopupMenu dacpopup_3,pos={293,226},size={113,20}	PopupMenu dacpopup_3,mode=1,popvalue="StepPulse_DAC",value=#"\"_none_;\"+GetPopupItems(\"DAC\")"	CheckBox ttlon_0,pos={509,10},size={43,14},proc=ADCDACcheckProc,title="TTL0"	CheckBox ttlon_0,value= 0	CheckBox ttlon_1,pos={509,37},size={43,14},proc=ADCDACcheckProc,title="TTL1"	CheckBox ttlon_1,value= 0	CheckBox ttlon_2,pos={509,63},size={43,14},proc=ADCDACcheckProc,title="TTL2"	CheckBox ttlon_2,value= 0	CheckBox ttlon_3,pos={509,89},size={43,14},proc=ADCDACcheckProc,title="TTL3"	CheckBox ttlon_3,value= 0	PopupMenu ttlpopup_0,pos={585,10},size={67,20}	PopupMenu ttlpopup_0,mode=1,popvalue="_none_",value=#"\"_none_;\"+GetPopupItems(\"TTL\")"	PopupMenu ttlpopup_1,pos={584,37},size={67,20}	PopupMenu ttlpopup_1,mode=1,popvalue="_none_",value=#"\"_none_;\"+GetPopupItems(\"TTL\")"	PopupMenu ttlpopup_2,pos={584,65},size={67,20}	PopupMenu ttlpopup_2,mode=1,popvalue="_none_",value=#"\"_none_;\"+GetPopupItems(\"TTL\")"	PopupMenu ttlpopup_3,pos={584,92},size={67,20}	PopupMenu ttlpopup_3,mode=1,popvalue="_none_",value=#"\"_none_;\"+GetPopupItems(\"TTL\")"	SetVariable multdac_0,pos={415,34},size={70,15},title="x "	SetVariable multdac_0,limits={-10000,10000,100},value= multdac0	SetVariable multdac_1,pos={416,98},size={70,15},title="x "	SetVariable multdac_1,limits={-10000,10000,100},value= multdac1	SetVariable multdac_2,pos={417,165},size={70,15},title="x "	SetVariable multdac_2,limits={-10000,10000,100},value= multdac2	SetVariable multdac_3,pos={417,227},size={70,15},title="x "	SetVariable multdac_3,limits={-10000,10000,100},value= multdac3	SetVariable setadcname_0,pos={203,12},size={70,15},proc=SetBaseNameProc,title="name"	SetVariable setadcname_0,value= adcname0	SetVariable setadcname_1,pos={202,43},size={70,15},proc=SetBaseNameProc,title="name"	SetVariable setadcname_1,value= adcname1	SetVariable setadcname_2,pos={202,75},size={70,15},proc=SetBaseNameProc,title="name"	SetVariable setadcname_2,value= adcname2	SetVariable setadcname_3,pos={202,106},size={70,15},proc=SetBaseNameProc,title="name"	SetVariable setadcname_3,value= adcname3	SetVariable setadcname_4,pos={201,137},size={70,15},proc=SetBaseNameProc,title="name"	SetVariable setadcname_4,value= adcname4	SetVariable setadcname_5,pos={202,166},size={70,15},proc=SetBaseNameProc,title="name"	SetVariable setadcname_5,value= adcname5	SetVariable setadcname_6,pos={200,198},size={70,15},proc=SetBaseNameProc,title="name"	SetVariable setadcname_6,value= adcname6	SetVariable setadcname_7,pos={200,230},size={70,15},proc=SetBaseNameProc,title="name"	SetVariable setadcname_7,value= adcname7	SetVariable setvar0,pos={540,139},size={100,25},title="ITC",fSize=18,format="%d"	SetVariable setvar0,limits={16,18,2},value= itc	SetDataFolder savDFEndMacroWindow Analysis() : Panel	PauseUpdate; Silent 1		// building window...	NewPanel /W=(757,44,1070,518) as "Analysis"	Button analyze,pos={1,1},size={70,18},proc=Analyze,title="Measure"	Button fit,pos={21,34},size={70,18},proc=Fit,title="Fit"	Button avgswps,pos={39,72},size={70,18},proc=AverageSweeps,title="Average"EndMacroWindow DACPulses() : Panel	PauseUpdate; Silent 1		// building window...	NewPanel /W=(19,424,175,658)	Button fivestep_button,pos={15,11},size={120,20},proc=FiveSegButtonProc,title="Five seg. wave"	Button train_button,pos={15,45},size={120,20},proc=TrainButtonProc,title="Train"	Button readwave_button,pos={15,174},size={120,20},proc=ReadwaveButtonProc,title="Read from file"	Button ramp_button,pos={15,77},size={120,20},proc=RampButtonProc,title="Ramp"	Button psc_button,pos={15,112},size={120,20},proc=PSCButtonProc,title="PSC wave"	Button sinewave_button,pos={15,144},size={120,20},proc=SineButtonProc,title="Sine wave"	Button viewwave_button,pos={15,204},size={120,20},proc=ViewDACButtonProc,title="View DAC"EndMacroWindow FiveSegBuilder() : Graph	PauseUpdate; Silent 1		// building window...	String fldrSav= GetDataFolder(1)	SetDataFolder root:DP_ADCDACcontrol:	Display /W=(80,150,780,450) Step5DAC	SetDataFolder fldrSav	ModifyGraph margin(top)=36	ModifyGraph grid(left)=1	ControlBar 90	SetVariable stepdur_0,pos={12,13},size={100,15},proc=StepVarProc,title="dur. 0"	SetVariable stepdur_0,limits={0,10000,10},value= root:DP_ADCDACcontrol:stepdur0	SetVariable stepdur_1,pos={132,11},size={100,15},proc=StepVarProc,title="dur. 1"	SetVariable stepdur_1,limits={0,10000,10},value= root:DP_ADCDACcontrol:stepdur1	SetVariable stepdur_2,pos={252,11},size={100,15},proc=StepVarProc,title="dur. 2"	SetVariable stepdur_2,limits={0,10000,10},value= root:DP_ADCDACcontrol:stepdur2	SetVariable stepdur_3,pos={368,11},size={100,15},proc=StepVarProc,title="dur. 3"	SetVariable stepdur_3,limits={0,10000,10},value= root:DP_ADCDACcontrol:stepdur3	SetVariable stepdur_4,pos={477,11},size={100,15},proc=StepVarProc,title="dur. 4"	SetVariable stepdur_4,limits={0,10000,10},value= root:DP_ADCDACcontrol:stepdur4	SetVariable stepamp_0,pos={12,39},size={100,15},proc=StepVarProc,title="amp. 0"	SetVariable stepamp_0,limits={-10000,10000,10},value= root:DP_ADCDACcontrol:stepamp0	SetVariable stepamp_1,pos={131,41},size={100,15},proc=StepVarProc,title="amp. 1"	SetVariable stepamp_1,limits={-10000,10000,10},value= root:DP_ADCDACcontrol:stepamp1	SetVariable stepamp_2,pos={252,38},size={100,15},proc=StepVarProc,title="amp. 2"	SetVariable stepamp_2,limits={-10000,10000,10},value= root:DP_ADCDACcontrol:stepamp2	SetVariable stepamp_3,pos={368,37},size={100,15},proc=StepVarProc,title="amp. 3"	SetVariable stepamp_3,limits={-10000,10000,10},value= root:DP_ADCDACcontrol:stepamp3	SetVariable stepamp_4,pos={478,37},size={100,15},proc=StepVarProc,title="amp. 4"	SetVariable stepamp_4,limits={-10000,10000,10},value= root:DP_ADCDACcontrol:stepamp4	Button save_dac,pos={607,11},size={80,20},proc=SaveDACButtonProc,title="Save As..."	SetVariable sint_pb,pos={594,37},size={120,15},proc=StepVarProc,title="sint. (ms)"	SetVariable sint_pb,limits={0.01,10,0.01},value= root:DP_ADCDACcontrol:sintpb	CheckBox ff_0,pos={28,61},size={62,14},proc=FromFileCheckProc,title="from file"	CheckBox ff_0,value= 0	CheckBox ff_1,pos={147,62},size={62,14},proc=FromFileCheckProc,title="from file"	CheckBox ff_1,value= 0  // ALT: Changed from 1 to fix error on 2012/05/18	CheckBox ff_2,pos={270,62},size={62,14},proc=FromFileCheckProc,title="from file"	CheckBox ff_2,value= 0	CheckBox ff_3,pos={383,60},size={62,14},proc=FromFileCheckProc,title="from file"	CheckBox ff_3,value= 0	CheckBox ff_4,pos={497,60},size={62,14},proc=FromFileCheckProc,title="from file"	CheckBox ff_4,value= 0	PopupMenu editwave_popup0,pos={587,63},size={98,20},proc=EditFiveSegWave,title="Edit: "	PopupMenu editwave_popup0,mode=1,popvalue="_none_",value= #"\"_none_;\"+GetPopupItems(\"DAC\")+GetPopupItems(\"TTL\")"	SetDrawLayer UserFront	SetDrawEnv fstyle= 1	DrawText -0.0500647382210309,-0.0603730897293596,"When done, save the wave with an extension _DAC or _TTL (TTL high should have an amplitude of 1)"	DrawLine -0.085,-0.0346,1.04,-0.0345EndMacroWindow TrainBuilder() : Graph	PauseUpdate; Silent 1		// building window...	String fldrSav= GetDataFolder(1)	SetDataFolder root:DP_ADCDACcontrol:	Display /W=(80,150,780,450) TrainDAC	SetDataFolder fldrSav	ModifyGraph margin(top)=36	ModifyGraph grid(left)=1	ControlBar 90	SetVariable train_num,pos={16,12},size={104,15},proc=TrainVarProc,title="number"	SetVariable train_num,limits={1,10000,1},value= root:DP_ADCDACcontrol:trainnum	SetVariable train_freq,pos={415,13},size={120,15},proc=TrainVarProc,title="frequency"	SetVariable train_freq,limits={0.001,10000,10},value= root:DP_ADCDACcontrol:trainfreq	SetVariable train_dur,pos={10,39},size={109,15},proc=TrainVarProc,title="duration"	SetVariable train_dur,limits={0.001,1000,1},value= root:DP_ADCDACcontrol:traindur	Button train_save,pos={570,8},size={90,20},proc=SaveDACButtonProc,title="Save As..."	SetVariable train_pre,pos={306,13},size={75,15},proc=TrainVarProc,title="pre"	SetVariable train_pre,limits={0,1000,1},value= root:DP_ADCDACcontrol:traindur0	SetVariable train_post,pos={299,38},size={85,15},proc=TrainVarProc,title="post"	SetVariable train_post,limits={0,1000,10},value= root:DP_ADCDACcontrol:traindur2	SetVariable train_amp,pos={142,38},size={120,15},proc=TrainVarProc,title="amplitude"	SetVariable train_amp,limits={-10000,10000,10},value= root:DP_ADCDACcontrol:trainamp	SetVariable train_sint,pos={417,38},size={120,15},proc=TrainVarProc,title="samp. int."	SetVariable train_sint,limits={0.01,1000,0.01},value= root:DP_ADCDACcontrol:sintpb	SetVariable train_base,pos={151,12},size={110,15},proc=TrainVarProc,title="baseline"	SetVariable train_base,limits={-10000,10000,1},value= root:DP_ADCDACcontrol:trainbase	PopupMenu edittrain_popup0,pos={571,38},size={98,20},proc=EditTrainWave,title="Edit: "	PopupMenu edittrain_popup0,mode=1,popvalue="_none_",value= #"\"_none_;\"+GetPopupItems(\"DAC\")+GetPopupItems(\"TTL\")"	SetDrawLayer UserFront	SetDrawEnv fstyle= 1	DrawText -0.06,-0.06,"When done, save the wave with an extension _DAC or _TTL (TTL high should have an amplitude of 1)"	DrawLine -0.085,-0.035,1.04,-0.035EndMacroWindow RampBuilder() : Graph	PauseUpdate; Silent 1		// building window...	String fldrSav= GetDataFolder(1)	SetDataFolder root:DP_ADCDACcontrol:	Display /W=(80,150,780,450) RampDAC	ModifyGraph margin(top)=36	ModifyGraph grid(left)=1	ControlBar 90	SetVariable ramp_amp1,pos={26,22},size={110,15},proc=RampVarProc,title="amplitude1"	SetVariable ramp_amp1,limits={-10000,10000,10},value= root:DP_ADCDACcontrol:rampamp1	SetVariable ramp_dur1,pos={27,49},size={110,15},proc=RampVarProc,title="duration1"	SetVariable ramp_dur1,limits={0,1000,1},value= root:DP_ADCDACcontrol:rampdur1	SetVariable ramp_dur2,pos={163,51},size={110,15},proc=RampVarProc,title="duration2"	SetVariable ramp_dur2,limits={1,100000,10},value= root:DP_ADCDACcontrol:rampdur2	SetVariable ramp_amp3,pos={285,20},size={110,15},proc=RampVarProc,title="amplitude3"	SetVariable ramp_amp3,limits={-10000,10000,10},value= root:DP_ADCDACcontrol:rampamp3	SetVariable ramp_dur3,pos={282,50},size={110,15},proc=RampVarProc,title="duration3"	SetVariable ramp_dur3,limits={1,100000,10},value= root:DP_ADCDACcontrol:rampdur3	SetVariable ramp_amp4,pos={422,20},size={110,15},proc=RampVarProc,title="amplitude4"	SetVariable ramp_amp4,limits={0,0,0},value= root:DP_ADCDACcontrol:rampamp4	SetVariable ramp_dur4,pos={422,50},size={110,15},proc=RampVarProc,title="duration4"	SetVariable ramp_dur4,limits={10,1000,10},value= root:DP_ADCDACcontrol:rampdur4	SetVariable ramp_sint,pos={551,35},size={110,15},proc=RampVarProc,title="samp. int."	SetVariable ramp_sint,limits={0.01,1000,0.01},value= root:DP_ADCDACcontrol:sintpb	Button train_save,pos={570,8},size={90,20},proc=SaveDACButtonProc,title="Save As..."	PopupMenu editramp_popup0,pos={565,59},size={95,20},proc=EditRampWave,title="Edit: "	PopupMenu editramp_popup0,mode=1,popvalue="_New_",value=#"\"_New_;\"+GetPopupItems(\"DAC\")+GetPopupItems(\"TTL\")"	SetDrawLayer UserFront	SetDrawEnv fstyle= 1	DrawText -0.046,-0.06,"When done, save the wave with an extension _DAC"	DrawLine -0.085,-0.035,1.04,-0.035	SetDataFolder fldrSavEndMacroWindow PSCBuilder() : Graph	String savDF=GetDataFolder(1)	SetDataFolder root:DP_ADCDACcontrol	PauseUpdate; Silent 1		// building window...	Display /W=(80,150,780,450) PSCDAC	ModifyGraph margin(top)=36	ModifyGraph grid(left)=1	ControlBar 90	SetVariable psc_pre,pos={42,12},size={110,17},proc=PSCVarProc,title="pre (ms)"	SetVariable psc_pre,limits={0,1000,1},value= pscdur0	SetVariable psc_post,pos={301,13},size={120,17},proc=PSCVarProc,title="post (ms)"	SetVariable psc_post,limits={10,1000,10},value= pscdur2	SetVariable psc_amp,pos={28,43},size={120,17},proc=PSCVarProc,title="amplitude"	SetVariable psc_amp,limits={-10000,10000,10},value= pscamp	SetVariable psc_taur,pos={163,43},size={120,17},proc=PSCVarProc,title="tau_rise"	SetVariable psc_taur,format="%g",limits={0,10000,0.1},value= psctaur	SetVariable psc_taud1,pos={289,42},size={130,17},proc=PSCVarProc,title="tau_decay1"	SetVariable psc_taud1,format="%g",limits={0,10000,1},value= psctaud1	SetVariable psc_taud2,pos={429,41},size={130,17},proc=PSCVarProc,title="tau_decay2"	SetVariable psc_taud2,format="%g",limits={0,10000,10},value= psctaud2	SetVariable psc_sint,pos={587,51},size={120,17},proc=pscVarProc,title="samp. int."	SetVariable psc_sint,limits={0.01,1000,0.01},value= sintpb	Button train_save,pos={585,5},size={90,20},proc=SaveDACButtonProc,title="Save As..."	SetVariable psc_dur,pos={173,13},size={110,17},proc=PSCVarProc,title="psc (ms)"	SetVariable psc_dur,limits={0,1000,10},value= pscdur1	SetVariable psc_wt_td2,pos={440,12},size={120,17},proc=PSCVarProc,title="weight td2"	SetVariable psc_wt_td2,format="%2.1f",limits={0,1,0.1},value= wttd2	PopupMenu editpsc_popup0,pos={584,28},size={100,19},proc=EditPSCWave,title="Edit: "	PopupMenu editpsc_popup0,mode=1,value=#"\"_New_;\"+GetPopupItems(\"DAC\")+GetPopupItems(\"TTL\")"	SetDrawLayer UserFront	SetDrawEnv fstyle= 1	DrawText -0.05,-0.06,"When done, save the wave with an extension _DAC"	DrawLine -0.085,-0.035,1.04,-0.035	SetDataFolder savDFEndMacroWindow SineBuilder() : Graph	String savDF=GetDataFolder(1)	SetDataFolder root:DP_ADCDACcontrol	PauseUpdate; Silent 1		// building window...	Display /W=(80,150,780,450) SineDAC	ModifyGraph margin(top)=36	ModifyGraph grid(left)=1	ControlBar 90	SetVariable sine_pre,pos={42,12},size={110,17},proc=sineVarProc,title="pre (ms)"	SetVariable sine_pre,limits={0,1000,1},value= sinedur0	SetVariable sine_post,pos={331,13},size={120,17},proc=sineVarProc,title="post (ms)"	SetVariable sine_post,limits={10,1000,10},value= sinedur2	SetVariable sine_amp,pos={128,43},size={120,17},proc=sineVarProc,title="amplitude"	SetVariable sine_amp,limits={-10000,10000,10},value= sineamp	SetVariable sine_freq,pos={286,41},size={130,17},proc=sineVarProc,title="freq. (Hz)"	SetVariable sine_freq,format="%g",limits={0,10000,10},value= sinefreq	SetVariable sine_sint,pos={466,12},size={120,17},proc=sineVarProc,title="samp. int."	SetVariable sine_sint,limits={0.01,1000,0.01},value= sintpb	Button train_save,pos={601,10},size={90,20},proc=SaveDACButtonProc,title="Save As..."	SetVariable sine_dur,pos={174,13},size={120,17},proc=SineVarProc,title="sine (ms)"	SetVariable sine_dur,format="%g",limits={0,10000,10},value= sinedur1	PopupMenu editsine_popup0,pos={578,42},size={100,19},proc=EditSineWave,title="Edit: "	PopupMenu editsine_popup0,mode=1,value=#"\"_New_;\"+GetPopupItems(\"DAC\")+GetPopupItems(\"TTL\")"	SetDrawLayer UserFront	SetDrawEnv fstyle= 1	DrawText -0.038,-0.06,"When done, save the wave with an extension _DAC"	DrawLine -0.085,-0.035,1.04,-0.035	SetDataFolder savDFEndMacroWindow DACViewer() : Graph	PauseUpdate; Silent 1		// building window...	String fldrSav= GetDataFolder(1)	SetDataFolder root:DP_ADCDACcontrol:	//Display /W=(78,138,698,408) ThetaTETNUS_DAC	String dacWaveNames=GetPopupItems("DAC")	String firstDacWaveName=StringFromList(0,DacWaveNames,";")	String popupItems, initialPopupItem	if ( strlen(firstDacWaveName)==0 )		popupItems="(none)"		initalPopupItem="(none)"	else		popupItems="(none);" + dacWaveNames		initialPopupItem=firstDacWaveName	endif	Display /W=(100,150,700,400) $initialPopupItem	ModifyGraph grid(left)=1	PopupMenu dacpopup,pos={650,20},size={115,20},proc=handleViewDACPopupSelection	String popupItemsStupidized="\""+popupItems+"\""	PopupMenu dacpopup,mode=3,popvalue=initialPopupItem,value=#popupItemsStupidized	//SetVariable disp0,pos={650,40},size={100,15},title="samp. int."	//SetVariable disp0,limits={0,0,0},value= root:DP_ADCDACcontrol:sintdisp	SetDataFolder fldrSavEndMacroWindow ImagingPanel() : Panel	PauseUpdate; Silent 1		// building window...	NewPanel /W=(757,268,1068,741)	Button flu_on,pos={10,40},size={130,20},proc=FluONButtonProc,title="Fluorescence ON"	Button flu_off,pos={10,10},size={130,20},proc=FluOFFButtonProc,title="Fluorescence OFF"	CheckBox imaging_check0,pos={14,244},size={114,14},proc=ImagingCheckProc,title="trigger filter wheel"	CheckBox imaging_check0,value= 1	Button button0,pos={215,283},size={80,20},proc=DFFButtonProc,title="Append DF/F"	Button button1,pos={9,190},size={130,20},proc=EphysImageButtonProc,title="Electrophys. + Image"	SetVariable setimagename0,pos={141,223},size={80,15},title="name"	SetVariable setimagename0,value= imageseq_name	CheckBox bkgndcheck0,pos={14,265},size={71,14},title="Bkgnd Sub.",value= 1	SetVariable numimages_setvar0,pos={11,223},size={120,15},title="No. images"	SetVariable numimages_setvar0,limits={1,10000,1},value= ccd_frames	SetVariable ccdtemp_setvar0,pos={13,311},size={150,15},proc=SetCCDTempVarProc,title="CCD Temp. Set"	SetVariable ccdtemp_setvar0,limits={-50,20,5},value= ccd_tempset	CheckBox showimageavg_check0,pos={14,286},size={84,14},title="Show Average"	CheckBox showimageavg_check0,value= 0	Button resetavg_button2,pos={212,253},size={80,20},proc=ResetAvgButtonProc,title="Reset Avg"	Button focus,pos={10,70},size={130,20},proc=FocusButtonProc,title="Focus"	Button full_frame,pos={10,130},size={130,20},proc=FullButtonProc,title="Full Frame Image"	SetVariable fluo_on_set,pos={178,40},size={120,15},title="ON   position"	SetVariable fluo_on_set,limits={0,9,1},value= fluo_on_wheel	SetVariable fluo_off_set,pos={177,10},size={120,15},title="OFF position"	SetVariable fluo_off_set,limits={0,9,1},value= fluo_off_wheel	SetVariable focusnum_set,pos={229,98},size={70,15},title="no."	SetVariable focusnum_set,limits={0,1000,1},value= focus_num	SetVariable fulltime_set,pos={152,130},size={150,15},title="Exp. time (ms)"	SetVariable fulltime_set,limits={0,10000,100},value= ccd_fullexp	SetVariable imagetime_setvar0,pos={149,193},size={150,15},title="Exp.time (ms)"	SetVariable imagetime_setvar0,limits={0,10000,10},value= ccd_seqexp	SetVariable setfullname0,pos={137,158},size={80,15},title="name"	SetVariable setfullname0,value= full_name	SetVariable setfocusname0,pos={139,99},size={80,15},title="name"	SetVariable setfocusname0,value= focus_name	ValDisplay tempdisp0,pos={174,311},size={120,14},title="CCD Temp."	ValDisplay tempdisp0,format="%3.1f",limits={0,0,0},barmisc={0,1000}	ValDisplay tempdisp0,value= #"ccd_temp"	SetVariable focustime_set,pos={151,70},size={150,15},title="Exp. time (ms)"	SetVariable focustime_set,limits={0,10000,100},value= ccd_focusexp	SetVariable fullnum_set,pos={230,159},size={70,15},title="no."	SetVariable fullnum_set,limits={0,1000,1},value= full_num	SetVariable imageseqnum_set,pos={227,223},size={70,15},title="no."	SetVariable imageseqnum_set,limits={0,10000,1},value= wavenumber	SetVariable roinum_set0,pos={117,341},size={90,15},proc=GetROIProc,title="ROI no."	SetVariable roinum_set0,format="%d",limits={1,2,1},value= roinum	SetVariable settop0,pos={182,371},size={77,15},proc=SetROIProc,title="top"	SetVariable settop0,format="%d",limits={0,512,1},value= roi_top	SetVariable setright0,pos={54,395},size={85,15},proc=SetROIProc,title="right"	SetVariable setright0,format="%d",limits={0,512,1},value= roi_right	SetVariable settleft0,pos={64,370},size={75,15},proc=SetROIProc,title="left"	SetVariable settleft0,format="%d",limits={0,512,1},value= roi_left	SetVariable setbottom0,pos={159,395},size={100,15},proc=SetROIProc,title="bottom"	SetVariable setbottom0,format="%d",limits={0,512,1},value= roi_bottom	SetVariable setxbin0,pos={55,419},size={85,15},proc=SetROIProc,title="x bin"	SetVariable setxbin0,format="%d",limits={0,512,1},value= xbin	SetVariable setybin0,pos={174,419},size={85,15},proc=SetROIProc,title="y bin"	SetVariable setybin0,format="%d",limits={0,512,1},value= ybin	ValDisplay xpixels0,pos={54,444},size={85,14},title="x pixels",format="%4.2f"	ValDisplay xpixels0,limits={0,0,0},barmisc={0,1000},value= #"xpixels"	ValDisplay ypixels0,pos={173,446},size={85,14},title="y pixels",format="%4.2f"	ValDisplay ypixels0,limits={0,0,0},barmisc={0,1000},value= #"ypixels"	Button getstac_button,pos={125,253},size={80,20},proc=StackButtonProc,title="GetStack"	CheckBox show_roi_check0,pos={109,286},size={94,14},title="Show ROI Image"	CheckBox show_roi_check0,value= 0EndMacro//------------- DataPro Analyze WINDOWS (keep at bottom, because they are long) ------------//Window AveragePanel() : Panel	PauseUpdate; Silent 1		// building window...	String savDF=GetDataFolder(1)	SetDataFolder root:DP_Analysis	NewPanel /W=(195,553,512,689) as "Average"	SetDrawLayer UserBack	SetDrawEnv fsize= 10,textrgb= (0,0,65535)	DrawText 17,42,"Channels selected in the browser window and meeting the "	SetDrawEnv fsize= 10,textrgb= (0,0,65535)	DrawText 63,55,"following criteria will be averaged."	Button avgnow,pos={7,5},size={180,20},proc=AverageSelectedSweeps,title="Average Selected Sweeps"	SetVariable avgfrom_disp,pos={22,63},size={100,17},title="Sweeps"	SetVariable avgfrom_disp,limits={1,2000,1},value= avgfrom	SetVariable avgto_disp,pos={128,63},size={66,17},title="To"	SetVariable avgto_disp,limits={1,2000,1},value= avgto	CheckBox range_all,pos={211,63},size={50,20},title="All",value=0	SetVariable avghold_disp,pos={47,89},size={75,17},title="Hold"	SetVariable avghold_disp,limits={-120,120,1},value= avghold	SetVariable holdtol_disp,pos={135,88},size={60,17},title="±"	SetVariable holdtol_disp,limits={-120,120,1},value= holdtolerance	CheckBox hold_all,pos={212,87},size={50,20},title="All",value=1	SetVariable avgstep_disp,pos={49,112},size={146,17},title="Step command"	SetVariable avgstep_disp,limits={-1000,1000,10},value= avgstep	CheckBox step_all,pos={212,110},size={50,20},title="All",value=1	CheckBox saveavg,pos={206,6},size={100,20},title="Save to disk",value=1	ValDisplay step1_disp,pos={388,5},size={64,17},title="Step"	ValDisplay step1_disp,limits={0,0,0},barmisc={0,1000},value= #" step1[iCurrentSweep]"	ValDisplay step2_disp,pos={388,24},size={64,17},title="Step"	ValDisplay step2_disp,limits={0,0,0},barmisc={0,1000},value= #" step2[iCurrentSweep]"	SetDataFolder savDFEndMacroWindow MeasurePanel(browserNumber) : Panel	Variable browserNumber // the number of the DataProBrowser we belong to		// Turn off window updates until we're done drawing, turn off echoing to console	PauseUpdate; Silent 1		// Save the current data folder, change to this browser's DF	String savedDF=ChangeToBrowserDF(browserNumber)		// From the browser number, derive the measure panel window name and title	String measureWindowName=sprintf1d("MeasurePanel%d",browserNumber)	String measureWindowTitle=sprintf1d("Measure %d",browserNumber)		// Create the globals related to the measure panel	Variable /G from1=10, to1=90	// these are parameters	Variable /G from2=90, to2=10	Variable /G lev1=nan  // this is a param, but want nan so it's clear that No. Crossings	                                // is meaningless initially	Variable /G base=nan, mean1=nan, peak1=nan, rise1=nan  // these are statistics	Variable /G mean2=nan, peak2=nan, rise2=nan	Variable /G cross1=nan		// Create the panel, draw all the controls	NewPanel /W=(740,45,1016,337)/N=$measureWindowName as measureWindowTitle	SetDrawLayer UserBack	DrawLine 8,42,245,42	DrawLine 6,170,243,170	DrawText 140,138,"%"	DrawText 227,136,"%"	DrawText 228,268,"%"	DrawText 137,268,"%"	DrawText 224,113,"ms"	DrawText 227,249,"ms"	//DrawText 227,225,"mV"	//DrawText 227,204,"mV"	//DrawText 223,93,"mV"	//DrawText 223,68,"mV"	//DrawText 227,23,"mV"	SetDrawEnv linethick= 3,linefgc= (3,52428,1)	DrawRect 2,58,108,84	SetDrawEnv linethick= 3,linefgc= (65535,0,0)	DrawRect 3,3,109,29	SetDrawEnv linethick= 3,linefgc= (0,0,65535)	DrawRect 5,187,111,213	Button setbase,pos={6,6},size={100,20},proc=SetBaseline,title="Set Baseline"	Button setwin_1,pos={5,61},size={100,20},proc=SetWin,title="Set Window 1"	Button setwin_2,pos={8,190},size={100,20},proc=SetWin,title="Set Window 2"	String browserDFName=BrowserDFNameFromNumber(browserNumber)	String absVarName=AbsoluteVarName(browserDFName,"base")	ValDisplay mean_base,pos={139,8},size={82,17},title="Mean",format="%4.2f"	ValDisplay mean_base,limits={0,0,0},barmisc={0,1000},value= #absVarName	absVarName=AbsoluteVarName(browserDFName,"mean1")	ValDisplay mean_disp1,pos={138,54},size={82,17},title="Mean",format="%4.2f"	ValDisplay mean_disp1,limits={0,0,0},barmisc={0,1000},value= #absVarName	absVarName=AbsoluteVarName(browserDFName,"peak1")	ValDisplay peak_disp1,pos={140,78},size={79,17},title="Peak",format="%4.2f"	ValDisplay peak_disp1,limits={0,0,0},barmisc={0,1000},value= #absVarName	absVarName=AbsoluteVarName(browserDFName,"rise1")	ValDisplay rise_disp1,pos={115,99},size={105,17},title="Transit Time"	ValDisplay rise_disp1,format="%4.2f",limits={0,0,0},barmisc={0,1000}	ValDisplay rise_disp1,value= #absVarName	absVarName=AbsoluteVarName(browserDFName,"from1")	SetVariable from_disp1,pos={54,122},size={80,17},proc=UpdateRise,title="From"	SetVariable from_disp1,limits={0,100,10},value=$absVarName	absVarName=AbsoluteVarName(browserDFName,"to1")	SetVariable to_disp1,pos={154,122},size={66,17},proc=UpdateRise,title="To"	SetVariable to_disp1,limits={0,100,10},value=$absVarName		absVarName=AbsoluteVarName(browserDFName,"lev1")	SetVariable lev_disp1,pos={18,145},size={80,17},proc=UpdateLevels,title="Level"	SetVariable lev_disp1,limits={-100,100,10},format="%4.2f",value=$absVarName		absVarName=AbsoluteVarName(browserDFName,"cross1")	ValDisplay cross_disp1,pos={110,145},size={110,17},title="No. Crossings"	ValDisplay cross_disp1,limits={0,0,0},barmisc={0,1000},format="%4.0f",value= #absVarName		absVarName=AbsoluteVarName(browserDFName,"mean2")	ValDisplay mean_disp2,pos={139,189},size={82,17},title="Mean",format="%4.2f"	ValDisplay mean_disp2,limits={0,0,0},barmisc={0,1000},value= #absVarName		absVarName=AbsoluteVarName(browserDFName,"peak2")	ValDisplay peak_disp2,pos={142,211},size={79,17},title="Peak",format="%4.2f"	ValDisplay peak_disp2,limits={0,0,0},barmisc={0,1000},value= #absVarName		absVarName=AbsoluteVarName(browserDFName,"rise2")	ValDisplay rise_disp2,pos={116,233},size={105,17},title="Transit Time"	ValDisplay rise_disp2,format="%4.2f",limits={0,0,0},barmisc={0,1000}	ValDisplay rise_disp2,value= #absVarName		absVarName=AbsoluteVarName(browserDFName,"from2")	SetVariable from_disp2,pos={49,253},size={80,17},proc=UpdateRise,title="From"	SetVariable from_disp2,limits={0,100,10},value= $absVarName		absVarName=AbsoluteVarName(browserDFName,"to2")	SetVariable to_disp2,pos={155,254},size={66,17},proc=UpdateRise,title="To"	SetVariable to_disp2,limits={0,100,10},value= $absVarName		// Restore original data folder	SetDataFolder savedDFEndMacroWindow FitPanel() : Panel	PauseUpdate; Silent 1		// building window...	NewPanel /W=(528,553,804,711) as "Exponential Fit"	SetDrawLayer UserBack	DrawText 84,79,"ms"	DrawText 199,78,"ms"	DrawText 84,97,"mV"	DrawText 199,95,"mV"	DrawText 111,138,"ms beyond range"	SetDrawEnv linethick= 3,linefgc= (0,65535,65535)	DrawRect 119,33,225,59	SetDrawEnv linethick= 3,linefgc= (26411,1,52428)	DrawRect 5,33,111,59	DrawText 230,117,"mV"	Button dofit,pos={123,10},size={100,20},proc=ExponentialFit,title="Fit"	Button set_fit_zero,pos={8,36},size={100,20},proc=SetFitZero,title="Set Zero"	Button set_fit_range,pos={123,36},size={100,20},proc=SetFitRange,title="Set Range"	PopupMenu fit_function,pos={8,10},size={90,19}	PopupMenu fit_function,mode=1,value= #"\"single exp;double exp\""	ValDisplay tau1_disp,pos={6,64},size={75,17},title="tau 1  ",format="%4.2f"	ValDisplay tau1_disp,limits={0,0,0},barmisc={0,1000},value= #"tau1"	ValDisplay amp1_disp,pos={5,82},size={75,17},title="amp 1",format="%4.2f"	ValDisplay amp1_disp,limits={0,0,0},barmisc={0,1000},value= #"amp1"	ValDisplay tau2_disp,pos={119,64},size={75,17},title="tau 2  ",format="%4.2f"	ValDisplay tau2_disp,limits={0,0,0},barmisc={0,1000},value= #"tau2"	ValDisplay amp2_disp,pos={119,81},size={75,17},title="amp 2",format="%4.2f"	ValDisplay amp2_disp,limits={0,0,0},barmisc={0,1000},value= #"amp2"	SetVariable setvar0,pos={7,125},size={98,17},title="Show fit"	SetVariable setvar0,limits={0,10000,10},value= fitextend	ValDisplay fitbase_disp,pos={7,102},size={90,17},title="baseline",format="%4.2f"	ValDisplay fitbase_disp,limits={0,0,0},barmisc={0,1000},value= #"fitbase"	CheckBox fitbase_check,pos={105,100},size={50,20},title="Hold",value=0	SetVariable fitbase_hold,pos={156,103},size={70,17},title="at",format="%4.2f"	SetVariable fitbase_hold,limits={-Inf,Inf,1},value= K0EndMacroWindow ShowAccessoryWaves() : Table	PauseUpdate; Silent 1		// building window...	Edit/W=(5,42,966,557) hold1,step1,avgflag1,reject1,bsub1	AppendToTable hold2,step2,avgflag2,reject2, bsub2EndMacro